
{%- liquid
      assign swatch_trigger = 'Color' | downcase
      assign swatch_file_extension = 'png'
      assign color_count = 0
    -%}

    {%- for option in product.options_with_values -%}
      {%- liquid
        assign option_name = option.name | downcase
        assign is_color = false
        if option_name contains swatch_trigger
          assign is_color = true
        elsif swatch_trigger == 'color' and option_name contains 'colour'
          assign is_color = true
        endif
      -%}
      {%- if is_color -%}
        {%- assign option_index = forloop.index0 -%}
        {%- assign values = '' -%}
        <div class="Product-variants Product-variants-{{ product.id }}">
          {%- for variant in product.variants -%}
            {%- assign value = variant.options[option_index] %}
            {%- unless values contains value -%}
              {%- liquid
                assign values = values | join: ',' | append: ',' | append: value | split: ','

                assign color_file_name = value | handle | append: '.' | append: swatch_file_extension
                assign color_image = color_file_name | file_img_url: '50x50' | prepend: 'https:' | split: '?' | first
                assign color_swatch_fallback = value | split: ' ' | last | handle
                assign color_count = color_count | plus: 1
              -%}

              <label for="variant_{{ option-name }}-{{ product-handle }}-{{ forloop.index0 }}"
              class="single-product-option-{{ option-name }}__label color-swatch {% if stripped-value contains 'white' %}single-product-option-{{ option-name }}__label--white{% endif %}"
              >      
           <input type="radio" name="{{ value }}-{{ product.handle }}"
           class="single-option-selector color-swatch single-product-option-{{ option-name }}__input js-radio-button"
           data-single-option-selector
           {% if option.selected_value == value %}checked="checked"{% endif %}  
           id="variant_{{ value }}-{{ product.handle }}-{{ forloop.index0 }}"/>
           <span class="swatch" style="background-color: {{ color_swatch_fallback }};"> </span>
           </label>
          
          
          
          
          
            {%- endunless -%}
           {%- endfor -%}
        </div>
        {%- if color_count < 2 -%}
          {%- style -%}
            .grid-product__colors--{{ product.id }} {
              display: none;
            }
          {%- endstyle -%}
        {%- endif -%}
      {%- endif -%}
    {%- endfor -%}